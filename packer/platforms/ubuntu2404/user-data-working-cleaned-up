#cloud-config
# See the autoinstall documentation at:
# https://canonical-subiquity.readthedocs-hosted.com/en/latest/reference/autoinstall-reference.html
autoinstall:
  version: 1
  identity:
    hostname: ubuntu2404
    password: $6$OhGpqVY2W1b.7teR$JkeMYz780m4DpVARL0uaB1ksjV36tSmKon5LB2rnpLij7F11vNyYve.NUiExzev6aE6yhoM6q8yA3UEpw7ozf/
    realname: Kyle Barstow
    username: kyle
  kernel:
    package: linux-generic
  keyboard:
    layout: us
  locale: en_US.UTF-8
  packages:
    - cifs-utils
    - cloud-init
    - libnfs-utils
  source:
    id: ubuntu-server
    search_drivers: false
  ssh:
    allow-pw: true
    authorized-keys: []
    install-server: true
  storage:
    config:
    # Physical disk
    - ptable: gpt
      serial: 0QEMU_QEMU_HARDDISK_drive-scsi0
      path: /dev/sda
      preserve: false
      name: ''
      grub_device: false
      id: disk-sda
      type: disk

    # /boot/efi
    - device: disk-sda
      size: 1127219200
      wipe: superblock
      flag: boot
      number: 1
      preserve: false
      grub_device: true
      offset: 1048576
      path: /dev/sda1
      id: partition-0
      type: partition
    - fstype: vfat
      volume: partition-0
      preserve: false
      id: format-0
      type: format
    - path: /boot/efi
      device: format-0
      id: mount-0
      type: mount

    # /boot
    - device: disk-sda
      size: 1073741824
      wipe: superblock
      number: 2
      preserve: false
      grub_device: false
      offset: 1128267776
      path: /dev/sda2
      id: partition-1
      type: partition
    - fstype: xfs
      volume: partition-1
      preserve: false
      id: format-1
      type: format
    - path: /boot
      device: format-1
      id: mount-1
      type: mount

    # LVM physical volumes
    - device: disk-sda
      size: 51484033024
      wipe: superblock
      number: 3
      preserve: false
      grub_device: false
      offset: 2202009600
      path: /dev/sda3
      id: partition-2
      type: partition

    # LVM volume groups
    - name: systemvg
      devices:
      - partition-2
      preserve: false
      id: lvm_volgroup-0
      type: lvm_volgroup

    # /
    - name: sysroot
      volgroup: lvm_volgroup-0
      size: 10737418240B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/sysroot
      id: lvm_partition-0
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-0
      preserve: false
      id: format-2
      type: format
    - path: /
      device: format-2
      id: mount-2
      type: mount

    # /home
    - name: home
      volgroup: lvm_volgroup-0
      size: 4294967296B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/home
      id: lvm_partition-1
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-1
      preserve: false
      id: format-3
      type: format
    - path: /home
      device: format-3
      id: mount-3
      type: mount

    # /opt
    - name: opt
      volgroup: lvm_volgroup-0
      size: 4294967296B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/opt
      id: lvm_partition-2
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-2
      preserve: false
      id: format-4
      type: format
    - path: /opt
      device: format-4
      id: mount-4
      type: mount

    # /var
    - name: var
      volgroup: lvm_volgroup-0
      size: 10737418240B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/var
      id: lvm_partition-3
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-3
      preserve: false
      id: format-5
      type: format
    - path: /var
      device: format-5
      id: mount-5
      type: mount

    # /var/log
    - name: varlog
      volgroup: lvm_volgroup-0
      size: 5368709120B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/varlog
      id: lvm_partition-4
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-4
      preserve: false
      id: format-6
      type: format
    - path: /var/log
      device: format-6
      id: mount-6
      type: mount

    # /var/log/audit
    - name: varlogaudit
      volgroup: lvm_volgroup-0
      size: 4294967296B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/varlogaudit
      id: lvm_partition-5
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-5
      preserve: false
      id: format-7
      type: format
    - path: /var/log/audit
      device: format-7
      id: mount-7
      type: mount

    # /var/tmp
    - name: vartmp
      volgroup: lvm_volgroup-0
      size: 4294967296B
      wipe: superblock
      preserve: false
      path: /dev/systemvg/vartmp
      id: lvm_partition-6
      type: lvm_partition
    - fstype: xfs
      volume: lvm_partition-6
      preserve: false
      id: format-8
      type: format
    - path: /var/tmp
      device: format-8
      id: mount-8
      type: mount
  updates: security
